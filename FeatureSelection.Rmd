---
title: "Feature Selection"
output: html_document
date: "2025-06-03"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

##Feature Selection Methods going to use: Information Gain, Mutual Information, Chi-Squared, Fisher's Score, Pearson's Correlation Coefficient (R), Variance Threshold
#Start with 20 features maybe eliminate down to like top 10 then once have that can design experiment

##Information Gain packages loaded in
```{r}
install.packages("funModeling")
library(funModeling)
```

##Load in data
```{r}
data <- read.csv("~/Desktop/Personal/Football ML/Football Data/Punt Data/PuntDataPulled.csv")
data_norm <- read.csv("~/Desktop/Personal/Football ML/Football Data/Punt Data/PuntDataFinal.csv")
```

##Run Information Gain Ratio, omit height and weight

```{r}
IG_PlayerIDP <- gain_ratio(data$PlayerIDP, data$Efficiency)
IG_PLocID <- gain_ratio(data$PLocID, data$Efficiency)
IG_PlayerIDLS <- gain_ratio(data$PlayerIDLS, data$Efficiency)
IG_SnapLocID <- gain_ratio(data$SnapLocID, data$Efficiency)
IG_PDate <- gain_ratio(data$PDate, data$Efficiency)
IG_Snaptime <- gain_ratio(data$Snaptime, data$Efficiency)
IG_OP <- gain_ratio(data$OP, data$Efficiency)
IG_H2F <- gain_ratio(data$H2F, data$Efficiency)
IG_Hang <- gain_ratio(data$Hang, data$Efficiency)
IG_Distance <- gain_ratio(data$Distance, data$Efficiency)
IG_Practice <- gain_ratio(data$Practice, data$Efficiency)
IG_Game <- gain_ratio(data$Game, data$Efficiency)
IG_Precipitation <- gain_ratio(data$precipitation, data$Efficiency)
IG_Wind <- gain_ratio(data$Wind, data$Efficiency)
IG_Grass <- gain_ratio(data$Grass, data$Efficiency)
IG_Turf <- gain_ratio(data$Turf, data$Efficiency)
IG_Temp <- gain_ratio(data$Temp, data$Efficiency)
```

##Mutual Information (MI) loading packages in
```{r}
install.packages("FSelectorRcpp")
library(FSelectorRcpp)
```
##Running MI on only discrete data, omit height and weight as well
```{r}
MI_PlayerIDP <- mutinformation(data$PlayerIDP, data$Efficiency, method = "emp")
MI_PlocID <- mutinformation(data$PLocID, data$Efficiency, method = "emp")
MI_PlayerIDLS <- mutinformation(data$PlayerIDLS, data$Efficiency, method = "emp")
MI_SnapLocID <- mutinformation(data$SnapLocID, data$Efficiency, method = "emp")
MI_PDate <- mutinformation(data$PDate, data$Efficiency, method = "emp")
#mutinformation(data$Snaptime, data$Efficiency, method = "emp") ##ommitted due to continuous
#mutinformation(data$OP, data$Efficiency, method = "emp")       ##ommitted due to continuous
#mutinformation(data$H2F, data$Efficiency, method = "emp")     ##ommitted due to continuous
#mutinformation(data$Hang, data$Efficiency, method = "emp")
MI_Distance <- mutinformation(data$Distance, data$Efficiency, method = "emp")
MI_Practice <- mutinformation(data$Practice, data$Efficiency, method = "emp")
MI_Game <- mutinformation(data$Game, data$Efficiency, method = "emp")
MI_Wind <- mutinformation(data$Wind, data$Efficiency, method = "emp")
MI_Grass <- mutinformation(data$Grass, data$Efficiency, method = "emp")
MI_Turf <- mutinformation(data$Turf, data$Efficiency, method = "emp")
```

##Installing Chi-Squared packages
```{r}
install.packages("MASS")
library(MASS)
```
```{r}
summary(data$H2F)
```


##Creating Contingency Tables
```{r}
##Creates Bins for Distance Feature
summary(data$Distance)
data$DistanceCat <- cut (
  data$Distance, 
  breaks = c(-Inf, 37, 46, Inf),
  labels = c("Short", "Medium", "Long"),
  right = TRUE
)
## Contingency Table for Distance and Effiency
dist = data.frame(data$DistanceCat, data$Efficiency)
dist = table(data$DistanceCat, data$Efficiency)
print(dist)

## Game Bins
data$GameCat <- cut (
  data$Game,
  breaks = c(-Inf, 1, 4, Inf),
  labels = c("Practice", "Non-Conference", "Conference"),
  right = TRUE
)

##Contingency Table For Game and Effiency

game = data.frame (data$GameCat, data$Efficiency)
game = table(data$GameCat, data$Efficiency)
print(game)

##Grass Bins
data$GrassCat <- cut (
  data$Grass,
  breaks = c(-Inf, 0, 1),
  labels = c("Grass", "Turf"),
  right = TRUE
)

##Grass Contingency Table

grass = data.frame(data$GrassCat, data$Efficiency)
grass = table(data$GrassCat, data$Efficiency)
print(grass)

##H2F Bins

data$H2FCat <- cut (
  data$H2F,
  breaks = c(-Inf, 1.220, 1.4, Inf),
  labels = c("Great", "Average", "Poor"),
  right = TRUE
)

##H2F Contingency Table

H2F = data.frame(data$H2FCat, data$Efficiency)
H2F = table(data$H2FCat, data$Efficiency)
print(H2F)

```
##Applying Chi2
```{r}
DistanceChi <- print(chisq.test(dist)) ## test for dist
GameChi <- print(chisq.test(game)) ##test for game
GrassChi <- print(chisq.test(grass)) ##Test for grass
H2FChi <- print(chisq.test(H2F)) ## test for hand to foot
```
##Visualizing Chi2
```{r}
barplot(dist, beside = TRUE, col = c("orange", "green"),
        main = "Distance vs Effiency",
        xlab = "Effiency",
        ylab = "Number")
legend("center", legend = rownames(dist), fill = c("orange", "green"))
```

